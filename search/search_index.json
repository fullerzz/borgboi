{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Overview","text":""},{"location":"#borgboi-docs","title":"BorgBoi Docs","text":"BorgBackup - The engine behind BorgBoi <p>This project wouldn't be possible without the underlying technology that is BorgBackup or Borg for short.</p> <p>BorgBackup (short: Borg) is a deduplicating backup program. Optionally, it supports compression and authenticated encryption. The main goal of Borg is to provide an efficient and secure way to backup data. The data deduplication technique used makes Borg suitable for daily backups since only changes are stored. The authenticated encryption technique makes it suitable for backups to not fully trusted targets.</p> <p>Their full documentation is available here: https://borgbackup.readthedocs.io.</p>"},{"location":"#what-is-borgboi","title":"What is BorgBoi?","text":"<p>BorgBoi is a thin wrapper around the BorgBackup tool that I will refer to as Borg from here on out.</p> <p>It contains the following features:</p> <ul> <li>Daily backup command that creates a new archive, prunes stale archives, and compacts the Borg repository to free up space</li> <li>Metadata about your Borg repositories is stored in DynamoDB (or locally in offline mode)</li> <li>Borg repositories are synced with S3 to enable cloud backups and archive restoration from other systems</li> <li>Offline mode support for users who prefer not to use AWS services</li> <li>Hierarchical CLI with organized subcommands (<code>repo</code>, <code>backup</code>, <code>s3</code>, <code>exclusions</code>, <code>config</code>)</li> <li>Secure passphrase management with file-based storage and auto-generation</li> </ul>"},{"location":"#quick-start","title":"Quick Start","text":"<pre><code># Create a new repository\nbb repo create --path /opt/borg-repos/docs \\\n    --backup-target ~/Documents \\\n    --name my-docs-backup\n\n# Run a daily backup\nbb backup daily --name my-docs-backup\n\n# List all repositories\nbb repo list\n\n# View archives in a repository\nbb backup list --name my-docs-backup\n</code></pre>"},{"location":"#installation","title":"Installation","text":"<p>BorgBoi isn't published to PyPI yet, so it is recommended to install it with <code>uv</code>.</p> <pre><code>uv tool install git+https://github.com/fullerzz/borgboi\n</code></pre> <p>Additionally, BorgBackup needs to be installed on your system for BorgBoi to work.</p> <p>Read installation methods here: https://borgbackup.readthedocs.io/en/stable/installation.html.</p>"},{"location":"#github-repo","title":"GitHub Repo","text":"<p>https://github.com/fullerzz/borgboi</p> <p></p>"},{"location":"pages/commands/","title":"Commands","text":""},{"location":"pages/commands/#borgboi-commands","title":"BorgBoi Commands","text":"<p>CLI Structure</p> <p>BorgBoi uses a hierarchical CLI with subcommand groups: <code>repo</code>, <code>backup</code>, <code>s3</code>, <code>exclusions</code>, and <code>config</code>. Legacy flat commands (like <code>create-repo</code>, <code>daily-backup</code>) are still available for backward compatibility.</p> <p>Offline Mode</p> <p>All commands support an <code>--offline</code> flag (or <code>BORGBOI_OFFLINE</code> environment variable) that enables offline mode. In offline mode, BorgBoi stores repository metadata locally in <code>~/.borgboi/.borgboi_metadata/</code> instead of using AWS DynamoDB and S3 services.</p>"},{"location":"pages/commands/#repository-commands-repo","title":"Repository Commands (<code>repo</code>)","text":""},{"location":"pages/commands/#repo-create","title":"<code>repo create</code>","text":"<pre><code>Usage: bb repo create [OPTIONS]\n\n  Create a new Borg repository.\n\nOptions:\n  -p, --path PATH           Path to create repository  [required]\n  -b, --backup-target PATH  Directory to back up  [required]\n  -n, --name TEXT           Repository name  [required]\n  --passphrase TEXT         Passphrase (auto-generated if not provided)\n</code></pre>"},{"location":"pages/commands/#repo-list","title":"<code>repo list</code>","text":"<pre><code>Usage: bb repo list [OPTIONS]\n\n  List all BorgBoi repositories.\n</code></pre> <p>Offline Mode Limitation</p> <p>The <code>repo list</code> command is not yet implemented in offline mode. Use <code>repo info</code> to access individual repositories by name or path in offline mode.</p>"},{"location":"pages/commands/#repo-info","title":"<code>repo info</code>","text":"<pre><code>Usage: bb repo info [OPTIONS]\n\n  Show repository information.\n\nOptions:\n  -p, --path PATH      Repository path\n  -n, --name TEXT      Repository name\n  --passphrase TEXT    Passphrase override\n  --raw                Show raw Borg output instead of formatted\n</code></pre>"},{"location":"pages/commands/#repo-delete","title":"<code>repo delete</code>","text":"<pre><code>Usage: bb repo delete [OPTIONS]\n\n  Delete a Borg repository.\n\nOptions:\n  -p, --path PATH      Repository path\n  -n, --name TEXT      Repository name\n  --dry-run            Simulate deletion without making changes\n  --passphrase TEXT    Passphrase override\n  --delete-from-s3     Also delete from S3\n</code></pre>"},{"location":"pages/commands/#backup-commands-backup","title":"Backup Commands (<code>backup</code>)","text":""},{"location":"pages/commands/#backup-run","title":"<code>backup run</code>","text":"<pre><code>Usage: bb backup run [OPTIONS]\n\n  Create a new backup archive.\n\nOptions:\n  -p, --path PATH      Repository path\n  -n, --name TEXT      Repository name\n  --passphrase TEXT    Passphrase override\n</code></pre> <p>Exclude File Resolution</p> <p>Backup commands (<code>backup run</code> and <code>backup daily</code>) resolve exclusion files in this order:</p> <ol> <li><code>~/.borgboi/{repo-name}_excludes.txt</code> (repository-specific)</li> <li><code>~/.borgboi/excludes.txt</code> (shared default)</li> </ol> <p>If neither file exists, backup fails with: <code>Exclude list must be created before performing a backup</code>.</p>"},{"location":"pages/commands/#backup-daily","title":"<code>backup daily</code>","text":"<pre><code>Usage: bb backup daily [OPTIONS]\n\n  Perform daily backup with prune and compact.\n\nOptions:\n  -p, --path PATH      Repository path\n  -n, --name TEXT      Repository name\n  --passphrase TEXT    Passphrase override\n  --no-s3-sync         Skip S3 sync after backup\n</code></pre> <p>Provide either <code>--path</code> or <code>--name</code> to select the repository.</p>"},{"location":"pages/commands/#backup-list","title":"<code>backup list</code>","text":"<pre><code>Usage: bb backup list [OPTIONS]\n\n  List archives in a repository.\n\nOptions:\n  -p, --path PATH      Repository path\n  -n, --name TEXT      Repository name\n  --passphrase TEXT    Passphrase override\n</code></pre>"},{"location":"pages/commands/#backup-contents","title":"<code>backup contents</code>","text":"<pre><code>Usage: bb backup contents [OPTIONS]\n\n  List contents of an archive.\n\nOptions:\n  -p, --path PATH      Repository path\n  -n, --name TEXT      Repository name\n  -a, --archive TEXT   Archive name  [required]\n  -o, --output TEXT    Output file path or 'stdout'  [default: stdout]\n  --passphrase TEXT    Passphrase override\n</code></pre>"},{"location":"pages/commands/#backup-restore","title":"<code>backup restore</code>","text":"<pre><code>Usage: bb backup restore [OPTIONS]\n\n  Restore an archive to the current directory.\n\nOptions:\n  -p, --path PATH      Repository path  [required]\n  -a, --archive TEXT   Archive name to restore  [required]\n  --passphrase TEXT    Passphrase override\n</code></pre>"},{"location":"pages/commands/#backup-delete","title":"<code>backup delete</code>","text":"<pre><code>Usage: bb backup delete [OPTIONS]\n\n  Delete an archive from a repository.\n\nOptions:\n  -p, --path PATH      Repository path  [required]\n  -a, --archive TEXT   Archive name to delete  [required]\n  --dry-run            Simulate deletion without making changes\n  --passphrase TEXT    Passphrase override\n</code></pre>"},{"location":"pages/commands/#s3-commands-s3","title":"S3 Commands (<code>s3</code>)","text":""},{"location":"pages/commands/#s3-sync","title":"<code>s3 sync</code>","text":"<pre><code>Usage: bb s3 sync [OPTIONS]\n\n  Sync a repository to S3.\n\nOptions:\n  -p, --path PATH      Repository path\n  -n, --name TEXT      Repository name\n</code></pre>"},{"location":"pages/commands/#s3-restore","title":"<code>s3 restore</code>","text":"<pre><code>Usage: bb s3 restore [OPTIONS]\n\n  Restore a repository from S3.\n\nOptions:\n  -p, --path PATH      Repository path\n  -n, --name TEXT      Repository name\n  --dry-run            Simulate restoration without making changes\n  --force              Force restore even if repository exists locally\n</code></pre>"},{"location":"pages/commands/#s3-delete","title":"<code>s3 delete</code>","text":"<pre><code>Usage: bb s3 delete [OPTIONS]\n\n  Delete a repository from S3.\n\nOptions:\n  -n, --name TEXT      Repository name  [required]\n  --dry-run            Simulate deletion without making changes\n</code></pre>"},{"location":"pages/commands/#s3-stats","title":"<code>s3 stats</code>","text":"<pre><code>Usage: bb s3 stats\n\n  Show general S3 bucket storage metrics and class composition.\n\n  Displays total bucket size, total object count, and a storage class breakdown\n  including Intelligent-Tiering tiers (FA/IA/AIA/AA/DAA) when available.\n  Values are sourced from AWS/S3 CloudWatch daily storage metrics.\n\n  Also includes inventory-based metadata for estimated upcoming\n  Intelligent-Tiering FA-&gt;IA transitions in the next 7 days.\n\n  Note: This forecast requires an enabled S3 Inventory configuration that\n  includes optional fields: Size, StorageClass,\n  IntelligentTieringAccessTier, and either LastAccessDate (preferred)\n  or LastModifiedDate (fallback). The first inventory delivery can take up to\n  48 hours after configuration.\n</code></pre>"},{"location":"pages/commands/#exclusions-commands-exclusions","title":"Exclusions Commands (<code>exclusions</code>)","text":""},{"location":"pages/commands/#exclusions-create","title":"<code>exclusions create</code>","text":"<pre><code>Usage: bb exclusions create [OPTIONS]\n\n  Create an exclusions file for a repository.\n\nOptions:\n  -p, --path PATH      Repository path  [required]\n  -s, --source FILE    Source file with exclusion patterns  [required]\n</code></pre>"},{"location":"pages/commands/#exclusions-show","title":"<code>exclusions show</code>","text":"<pre><code>Usage: bb exclusions show [OPTIONS]\n\n  Show exclusion patterns for a repository.\n\nOptions:\n  -n, --name TEXT      Repository name  [required]\n</code></pre>"},{"location":"pages/commands/#exclusions-add","title":"<code>exclusions add</code>","text":"<pre><code>Usage: bb exclusions add [OPTIONS]\n\n  Add an exclusion pattern to a repository.\n\nOptions:\n  -n, --name TEXT      Repository name  [required]\n  -x, --pattern TEXT   Exclusion pattern to add  [required]\n</code></pre>"},{"location":"pages/commands/#exclusions-remove","title":"<code>exclusions remove</code>","text":"<pre><code>Usage: bb exclusions remove [OPTIONS]\n\n  Remove an exclusion pattern by line number.\n\nOptions:\n  -n, --name TEXT      Repository name  [required]\n  -l, --line INTEGER   Line number to remove (1-based)  [required]\n</code></pre>"},{"location":"pages/commands/#configuration-commands-config","title":"Configuration Commands (<code>config</code>)","text":""},{"location":"pages/commands/#config-show","title":"<code>config show</code>","text":"<pre><code>Usage: bb config show [OPTIONS]\n\n  Display the current BorgBoi configuration.\n\nOptions:\n  -p, --path PATH           Custom path for the configuration file\n  -f, --format [yaml|json|tree]\n                            Output format  [default: yaml]\n  --pretty-print/--no-pretty-print\n                            Pretty print output using rich  [default: pretty-print]\n</code></pre>"},{"location":"pages/commands/#utility-commands","title":"Utility Commands","text":""},{"location":"pages/commands/#migrate-passphrases","title":"<code>migrate-passphrases</code>","text":"<pre><code>Usage: bb migrate-passphrases [OPTIONS]\n\n  Migrate repository passphrases from database to secure file storage.\n\n  Passphrases are migrated to ~/.borgboi/passphrases/{repo-name}.key\n  with 0o600 permissions.\n\nOptions:\n  -n, --repo-name TEXT   Specific repo to migrate (migrates all if omitted)\n  --offline              Enable offline mode (no AWS services)\n</code></pre>"},{"location":"pages/commands/#legacy-commands","title":"Legacy Commands","text":"<p>Backward Compatibility</p> <p>The following legacy commands are still available for backward compatibility but are deprecated. Consider using the new hierarchical commands above.</p> Legacy Command New Command <code>create-repo</code> <code>repo create</code> <code>list-repos</code> <code>repo list</code> <code>get-repo</code> <code>repo info</code> <code>repo-info</code> <code>repo info</code> <code>delete-repo</code> <code>repo delete</code> <code>daily-backup</code> <code>backup daily</code> <code>list-archives</code> <code>backup list</code> <code>list-archive-contents</code> <code>backup contents</code> <code>extract-archive</code> <code>backup restore</code> <code>delete-archive</code> <code>backup delete</code> <code>restore-repo</code> <code>s3 restore</code> <code>create-exclusions</code> <code>exclusions create</code> <code>append-excludes</code> <code>exclusions add</code> <code>modify-excludes</code> <code>exclusions remove</code> <code>export-repo-key</code> (no new equivalent)"},{"location":"pages/getting-started/","title":"Getting Started","text":""},{"location":"pages/getting-started/#getting-started","title":"Getting Started","text":"<p>Install BorgBackup</p> <p>Before proceeding further, make sure you have BorgBackup installed on your system. It is not bundled with BorgBoi currently.</p> <p>Read installation methods here: https://borgbackup.readthedocs.io/en/stable/installation.html.</p>"},{"location":"pages/getting-started/#installation","title":"Installation","text":"<p>BorgBoi isn't published to PyPI yet, so it is recommended to install it from the GitHub repo with <code>uv</code>.</p> <pre><code>uv tool install git+https://github.com/fullerzz/borgboi\n</code></pre> <p>Additionally, BorgBackup needs to be installed on your system for BorgBoi to work.</p> <p>Read installation methods here: https://borgbackup.readthedocs.io/en/stable/installation.html.</p>"},{"location":"pages/getting-started/#provision-aws-resources","title":"Provision AWS Resources","text":"<p>For BorgBoi to function properly in online mode, it requires an S3 bucket and DynamoDB table.</p> <p>Use the IAC present in the <code>terraform</code> directory to provision these resources on AWS with Terraform or OpenTofu.</p> <p>The Terraform/OpenTofu configuration also provisions S3 Inventory for the backup bucket so <code>bb s3 stats</code> can report upcoming Intelligent-Tiering FA-&gt;IA transition estimates.</p> <p>S3 Inventory delivery delay</p> <p>The first S3 Inventory report can take up to 48 hours after enabling the configuration.</p> <p>Offline Mode Available</p> <p>If you prefer not to use AWS services, BorgBoi also supports offline mode. See the Offline Mode section below.</p>"},{"location":"pages/getting-started/#configuration","title":"Configuration","text":"<p>BorgBoi uses a configuration file located at <code>~/.borgboi/config.yaml</code>. You can view the current configuration with:</p> <pre><code>bb config show\n</code></pre> <p>For a complete reference of every field, environment variable, and allowed value, see User Configuration.</p>"},{"location":"pages/getting-started/#configuration-file","title":"Configuration File","text":"<p>Create or edit <code>~/.borgboi/config.yaml</code>:</p> <pre><code>aws:\n  s3_bucket: my-borgboi-bucket\n  dynamodb_repos_table: bb-repos\n  region: us-west-1\n\nborg:\n  compression: zstd,6\n  storage_quota: 100G\n  retention:\n    keep_daily: 7\n    keep_weekly: 4\n    keep_monthly: 6\n    keep_yearly: 0\n\noffline: false\n</code></pre>"},{"location":"pages/getting-started/#environment-variables","title":"Environment Variables","text":"<p>Configuration can be overridden using environment variables with the <code>BORGBOI_</code> prefix:</p> Environment Variable Config Path Description <code>BORGBOI_OFFLINE</code> <code>offline</code> Enable offline mode <code>BORGBOI_DEBUG</code> <code>debug</code> Enable debug output <code>BORGBOI_AWS__S3_BUCKET</code> <code>aws.s3_bucket</code> S3 bucket for backup storage <code>BORGBOI_AWS__DYNAMODB_REPOS_TABLE</code> <code>aws.dynamodb_repos_table</code> DynamoDB table for repo metadata <code>BORGBOI_AWS__REGION</code> <code>aws.region</code> AWS region <code>BORGBOI_BORG__BORG_PASSPHRASE</code> <code>borg.borg_passphrase</code> Default passphrase for existing repos <code>BORGBOI_BORG__BORG_NEW_PASSPHRASE</code> <code>borg.borg_new_passphrase</code> Passphrase for new repos <p>Passphrase Handling</p> <p>BorgBoi uses a hierarchical passphrase resolution:</p> <ol> <li>Command-line <code>--passphrase</code> option (highest priority)</li> <li>Stored passphrase file (<code>~/.borgboi/passphrases/{repo-name}.key</code>)</li> <li>Environment variable (<code>BORGBOI_BORG__BORG_PASSPHRASE</code>)</li> <li>Config file (<code>borg.borg_passphrase</code>)</li> </ol> <p>For new repositories, BorgBoi can auto-generate passphrases and store them securely.</p>"},{"location":"pages/getting-started/#aws-credentials","title":"AWS Credentials","text":"<p>Before running BorgBoi in online mode, make sure the shell BorgBoi runs in has access to AWS credentials with sufficient permissions for the DynamoDB table and S3 bucket.</p>"},{"location":"pages/getting-started/#offline-mode","title":"Offline Mode","text":"<p>BorgBoi supports offline mode for users who prefer not to use AWS services or want to use BorgBoi without cloud dependencies.</p>"},{"location":"pages/getting-started/#enabling-offline-mode","title":"Enabling Offline Mode","text":"<p>You can enable offline mode in three ways:</p> <ol> <li>Configuration File: Set <code>offline: true</code> in <code>~/.borgboi/config.yaml</code></li> <li>Environment Variable: Set <code>BORGBOI_OFFLINE=1</code> in your environment</li> <li>Command Flag: Add <code>--offline</code> to any BorgBoi command</li> </ol>"},{"location":"pages/getting-started/#how-offline-mode-works","title":"How Offline Mode Works","text":"<p>In offline mode:</p> <ul> <li>Repository metadata is stored locally in <code>~/.borgboi/.borgboi_metadata/</code> instead of DynamoDB</li> <li>No S3 synchronization occurs during backups</li> <li>All Borg operations work normally (create, backup, extract, etc.)</li> <li>AWS credentials are not required</li> </ul>"},{"location":"pages/getting-started/#offline-mode-limitations","title":"Offline Mode Limitations","text":"<ul> <li>Repository restoration from S3 is not available</li> <li>Repository metadata is not shared across systems</li> <li>No cloud backup of repository metadata</li> <li>The <code>repo list</code> command is not yet implemented in offline mode</li> </ul>"},{"location":"pages/getting-started/#create-a-borgboi-repo","title":"Create a BorgBoi Repo","text":"<p>You can now create a Borg repository with the following BorgBoi command:</p> <pre><code>bb repo create --path /opt/borg-repos/docs \\\n    --backup-target ~/Documents \\\n    --name my-docs-backup\n</code></pre> <p>Or using the legacy command syntax:</p> <pre><code>bb create-repo --repo-path /opt/borg-repos/docs \\\n    --backup-target ~/Documents\n</code></pre> <p></p>"},{"location":"pages/getting-started/#perform-a-daily-backup","title":"Perform a Daily Backup","text":"<p>Run a daily backup with automatic pruning and compaction:</p> <pre><code>bb backup daily --name my-docs-backup\n</code></pre> <p>This command creates a new archive, prunes old archives based on retention policy, compacts the repository, and syncs to S3 (unless <code>--no-s3-sync</code> is specified or running in offline mode). You can also target the repository with <code>--path</code>.</p>"},{"location":"pages/getting-started/#list-your-repositories","title":"List Your Repositories","text":"<p>View all managed repositories:</p> <pre><code>bb repo list\n</code></pre>"},{"location":"pages/getting-started/#view-repository-info","title":"View Repository Info","text":"<p>Get detailed information about a repository:</p> <pre><code>bb repo info --name my-docs-backup\n</code></pre>"},{"location":"pages/getting-started/#list-archives","title":"List Archives","text":"<p>View all archives in a repository:</p> <pre><code>bb backup list --name my-docs-backup\n</code></pre>"},{"location":"pages/sqlite-database/","title":"SQLite Database","text":""},{"location":"pages/sqlite-database/#sqlite-database","title":"SQLite Database","text":"<p>BorgBoi uses SQLite for local metadata and cache storage. The database file is:</p> <ul> <li><code>~/.borgboi/.database/borgboi.db</code></li> </ul> <p>If <code>BORGBOI_HOME</code> is set, the path becomes:</p> <ul> <li><code>$BORGBOI_HOME/.borgboi/.database/borgboi.db</code></li> </ul>"},{"location":"pages/sqlite-database/#what-sqlite-stores","title":"What SQLite Stores","text":"<p>SQLite stores:</p> <ul> <li>Repository metadata (<code>repositories</code>)</li> <li>Cached S3 statistics (<code>s3_stats_cache</code>)</li> <li>Storage schema version (<code>schema_version</code>)</li> </ul> <p>It does not store the Borg repository contents themselves. Actual backup archives remain in Borg repositories on disk (and optionally S3).</p>"},{"location":"pages/sqlite-database/#database-lifecycle","title":"Database Lifecycle","text":"<pre><code>flowchart TD\n    A[Start SQLiteStorage] --&gt; B{DB file exists?}\n    B -- Yes --&gt; C[Open DB engine]\n    B -- No --&gt; D[Check legacy JSON data dirs]\n    D --&gt; E{Legacy data found?}\n    E -- No --&gt; F[Create empty SQLite DB]\n    E -- Yes --&gt; G[Create SQLite DB]\n    G --&gt; H[Migrate legacy repository JSON]\n    G --&gt; I[Migrate legacy S3 stats cache JSON]\n    H --&gt; C\n    I --&gt; C\n    F --&gt; C\n    C --&gt; J[Ensure tables exist]\n    J --&gt; K[Ensure schema_version row exists]\n    K --&gt; L[Use DB for reads and writes]</code></pre>"},{"location":"pages/sqlite-database/#schema-overview","title":"Schema Overview","text":"<pre><code>erDiagram\n    REPOSITORIES {\n        INTEGER id PK\n        STRING name UK\n        STRING path\n        STRING backup_target\n        STRING hostname\n        STRING os_platform\n        DATETIME last_backup\n        TEXT metadata_json\n        INTEGER retention_keep_daily\n        INTEGER retention_keep_weekly\n        INTEGER retention_keep_monthly\n        INTEGER retention_keep_yearly\n        DATETIME last_s3_sync\n        DATETIME created_at\n        STRING passphrase\n        STRING passphrase_file_path\n        BOOLEAN passphrase_migrated\n        DATETIME updated_at\n    }\n\n    S3_STATS_CACHE {\n        INTEGER id PK\n        STRING repo_name UK\n        BIGINT total_size_bytes\n        INTEGER object_count\n        DATETIME last_modified\n        DATETIME cached_at\n    }\n\n    SCHEMA_VERSION {\n        INTEGER id PK\n        INTEGER version\n        DATETIME applied_at\n    }\n\n    REPOSITORIES ||--o| S3_STATS_CACHE : \"repo name (app-level)\"</code></pre> <p>Relationship model</p> <p><code>repositories</code> and <code>s3_stats_cache</code> are related by repository name at the application layer (<code>repositories.name</code> &lt;-&gt; <code>s3_stats_cache.repo_name</code>). The current schema does not define a SQL foreign key constraint for this link.</p>"},{"location":"pages/sqlite-database/#table-details","title":"Table Details","text":""},{"location":"pages/sqlite-database/#repositories","title":"<code>repositories</code>","text":"<p>Primary table for BorgBoi repository metadata.</p> Column Type Nullable Constraints / Behavior <code>id</code> <code>INTEGER</code> No Primary key, auto-increment <code>name</code> <code>VARCHAR(255)</code> No Unique, indexed <code>path</code> <code>VARCHAR(1024)</code> No Used with hostname for uniqueness <code>backup_target</code> <code>VARCHAR(1024)</code> No Filesystem path being backed up <code>hostname</code> <code>VARCHAR(255)</code> No Indexed <code>os_platform</code> <code>VARCHAR(10)</code> No Host OS identifier <code>last_backup</code> <code>DATETIME</code> Yes Last successful backup timestamp <code>metadata_json</code> <code>TEXT</code> Yes Serialized repository info payload <code>retention_keep_daily</code> <code>INTEGER</code> Yes Optional per-repo retention override <code>retention_keep_weekly</code> <code>INTEGER</code> Yes Optional per-repo retention override <code>retention_keep_monthly</code> <code>INTEGER</code> Yes Optional per-repo retention override <code>retention_keep_yearly</code> <code>INTEGER</code> Yes Optional per-repo retention override <code>last_s3_sync</code> <code>DATETIME</code> Yes Last S3 synchronization time <code>created_at</code> <code>DATETIME</code> Yes Creation timestamp when set <code>passphrase</code> <code>VARCHAR(512)</code> Yes Legacy/inline passphrase storage <code>passphrase_file_path</code> <code>VARCHAR(1024)</code> Yes File path to passphrase material <code>passphrase_migrated</code> <code>BOOLEAN</code> No Defaults to <code>false</code> <code>updated_at</code> <code>DATETIME</code> No Auto-set on write and update <p>Additional unique constraint:</p> <ul> <li><code>UNIQUE(path, hostname)</code> via <code>uq_repo_path_hostname</code></li> </ul> <p>This allows the same <code>path</code> string to exist on different hosts while preventing duplicates on the same host.</p>"},{"location":"pages/sqlite-database/#s3_stats_cache","title":"<code>s3_stats_cache</code>","text":"<p>Caches S3 statistics for each repository to reduce repeated API calls.</p> Column Type Nullable Constraints / Behavior <code>id</code> <code>INTEGER</code> No Primary key, auto-increment <code>repo_name</code> <code>VARCHAR(255)</code> No Unique (one cache row per repository name) <code>total_size_bytes</code> <code>BIGINT</code> No Defaults to <code>0</code> <code>object_count</code> <code>INTEGER</code> No Defaults to <code>0</code> <code>last_modified</code> <code>DATETIME</code> Yes Last modified timestamp observed in S3 <code>cached_at</code> <code>DATETIME</code> No Timestamp when cache row was written"},{"location":"pages/sqlite-database/#schema_version","title":"<code>schema_version</code>","text":"<p>Tracks storage schema version.</p> Column Type Nullable Constraints / Behavior <code>id</code> <code>INTEGER</code> No Primary key, auto-increment <code>version</code> <code>INTEGER</code> No Current schema version <code>applied_at</code> <code>DATETIME</code> No Timestamp when this version row was inserted <p>Current initialization behavior inserts version <code>1</code> if no row exists.</p>"},{"location":"pages/sqlite-database/#operational-notes","title":"Operational Notes","text":"<ul> <li>SQLite is opened with <code>PRAGMA journal_mode=WAL</code> to improve concurrent read behavior.</li> <li>Tables are created through SQLAlchemy metadata (<code>create_all</code>) during initialization.</li> <li>Deleting a repository also deletes its <code>s3_stats_cache</code> row in application logic.</li> <li>Exclusions are not stored in SQLite; they are written to text files under <code>~/.borgboi/data/exclusions/</code>.</li> </ul>"},{"location":"pages/sqlite-database/#common-introspection-queries","title":"Common Introspection Queries","text":"<pre><code>-- List tables\nSELECT name FROM sqlite_master WHERE type = 'table' ORDER BY name;\n</code></pre> <pre><code>-- Show repository rows\nSELECT id, name, path, hostname, last_backup, updated_at\nFROM repositories\nORDER BY name;\n</code></pre> <pre><code>-- Show cached S3 stats\nSELECT repo_name, total_size_bytes, object_count, cached_at\nFROM s3_stats_cache\nORDER BY cached_at DESC;\n</code></pre> <pre><code>-- Show schema version row\nSELECT id, version, applied_at\nFROM schema_version\nORDER BY id DESC;\n</code></pre>"},{"location":"pages/user-configuration/","title":"User Configuration","text":""},{"location":"pages/user-configuration/#user-configuration","title":"User Configuration","text":"<p>This page documents every user-facing BorgBoi configuration field, its default, and its allowed values.</p>"},{"location":"pages/user-configuration/#where-configuration-comes-from","title":"Where Configuration Comes From","text":"<p>BorgBoi loads configuration from:</p> <ol> <li>Defaults defined in code</li> <li><code>~/.borgboi/config.yaml</code> (or <code>BORGBOI_HOME/.borgboi/config.yaml</code>)</li> <li><code>BORGBOI_*</code> environment variable overrides</li> <li>CLI flags for <code>--offline</code> and <code>--debug</code> (for command execution)</li> </ol> <p>Config file location</p> <p>BorgBoi resolves the home directory in this order:</p> <ol> <li><code>BORGBOI_HOME</code></li> <li><code>SUDO_USER</code> home directory (when running under <code>sudo</code>)</li> <li>Current user home (<code>Path.home()</code>)</li> </ol> <p>Then it uses <code>&lt;resolved-home&gt;/.borgboi/config.yaml</code>.</p>"},{"location":"pages/user-configuration/#default-configyaml","title":"Default <code>config.yaml</code>","text":"<pre><code>aws:\n  dynamodb_repos_table: bb-repos\n  dynamodb_archives_table: bb-archives\n  s3_bucket: bb-backups\n  region: us-west-1\n\nborg:\n  executable_path: borg\n  default_repo_path: ~/.borgboi/repositories\n  compression: zstd,6\n  checkpoint_interval: 900\n  storage_quota: 100G\n  additional_free_space: 2G\n  retention:\n    keep_daily: 7\n    keep_weekly: 4\n    keep_monthly: 6\n    keep_yearly: 0\n\nui:\n  theme: catppuccin\n  show_progress: true\n  color_output: true\n  table_style: rounded\n\noffline: false\ndebug: false\n</code></pre>"},{"location":"pages/user-configuration/#load-flow-with-environment-variables","title":"Load Flow With Environment Variables","text":"<pre><code>flowchart TD\n    A[Start get_config] --&gt; B[Resolve home directory]\n    B --&gt; C{BORGBOI_HOME set?}\n    C -- Yes --&gt; D[Use BORGBOI_HOME]\n    C -- No --&gt; E{SUDO_USER set and home exists?}\n    E -- Yes --&gt; F[Use sudo user's home]\n    E -- No --&gt; G[Use current user home]\n    D --&gt; H[Compute config path]\n    F --&gt; H\n    G --&gt; H\n    H --&gt; I{config.yaml exists?}\n    I -- No --&gt; J[Write default config.yaml]\n    I -- Yes --&gt; K[Read YAML data]\n    J --&gt; K\n    K --&gt; L[Apply BORGBOI_* overrides]\n    L --&gt; M[Validate with Pydantic model]\n    M --&gt; N[Optional warning checks]\n    N --&gt; O[Return effective Config]</code></pre> <pre><code>sequenceDiagram\n    participant CLI as CLI Command\n    participant CFG as get_config()\n    participant YAML as config.yaml\n    participant ENV as Environment\n\n    CLI-&gt;&gt;CFG: load config\n    CFG-&gt;&gt;YAML: read YAML (or create defaults)\n    YAML--&gt;&gt;CFG: raw config dict\n    loop for each known config path\n        CFG-&gt;&gt;ENV: read mapped BORGBOI_* variable\n        alt env var is set\n            ENV--&gt;&gt;CFG: string value\n            CFG-&gt;&gt;CFG: coerce bool/int when applicable\n            CFG-&gt;&gt;CFG: overwrite matching config path\n        else env var not set\n            ENV--&gt;&gt;CFG: None\n        end\n    end\n    CFG--&gt;&gt;CLI: final merged config</code></pre>"},{"location":"pages/user-configuration/#allowed-values-by-field","title":"Allowed Values By Field","text":""},{"location":"pages/user-configuration/#top-level-fields","title":"Top-Level Fields","text":"Key Type Default Allowed Values Notes <code>offline</code> boolean <code>false</code> <code>true</code> or <code>false</code> When <code>true</code>, skips AWS usage and uses local metadata storage. <code>debug</code> boolean <code>false</code> <code>true</code> or <code>false</code> Enables debug mode in CLI context."},{"location":"pages/user-configuration/#aws-section","title":"<code>aws</code> Section","text":"Key Type Default Allowed Values Notes <code>aws.dynamodb_repos_table</code> string <code>bb-repos</code> Any string Should be a valid DynamoDB table name you can access. <code>aws.dynamodb_archives_table</code> string <code>bb-archives</code> Any string Should be a valid DynamoDB table name you can access. <code>aws.s3_bucket</code> string <code>bb-backups</code> Any string Should be a valid S3 bucket name you can access. <code>aws.region</code> string <code>us-west-1</code> Any string Typically an AWS region like <code>us-east-1</code>, <code>eu-west-1</code>, etc. <code>aws.profile</code> string or <code>null</code> <code>null</code> Any string or <code>null</code> Optional AWS profile name."},{"location":"pages/user-configuration/#borg-section","title":"<code>borg</code> Section","text":"Key Type Default Allowed Values Notes <code>borg.executable_path</code> string <code>borg</code> Any string Command/path used to invoke Borg. Must be executable and in <code>PATH</code> unless absolute path is provided. <code>borg.default_repo_path</code> path string <code>~/.borgboi/repositories</code> Any valid path Base directory where repos are created by default. <code>borg.compression</code> string <code>zstd,6</code> <code>none</code>, <code>lz4</code>, <code>zstd</code>, <code>zlib</code>, <code>lzma</code>, optionally with level like <code>algorithm,N</code> Compression algorithm is validated against the listed algorithms. If level is provided, <code>N</code> should be an integer <code>0-22</code>. <code>borg.checkpoint_interval</code> integer <code>900</code> Any integer Warning is emitted when value is negative. Units are seconds. <code>borg.storage_quota</code> string <code>100G</code> Any string Recommended format is Borg size style like <code>500M</code>, <code>100G</code>, <code>2T</code>; invalid-looking formats may trigger warnings. <code>borg.additional_free_space</code> string <code>2G</code> Any string Free-space buffer passed to Borg operations that support it. <code>borg.borg_passphrase</code> string or <code>null</code> <code>null</code> Any string or <code>null</code> Default passphrase for existing repos when no higher-priority source is present. <code>borg.borg_new_passphrase</code> string or <code>null</code> <code>null</code> Any string or <code>null</code> Passphrase for new repo initialization when no higher-priority source is present."},{"location":"pages/user-configuration/#borgretention-subsection","title":"<code>borg.retention</code> subsection","text":"Key Type Default Allowed Values Notes <code>borg.retention.keep_daily</code> integer <code>7</code> Integer <code>&gt;= 0</code> Number of daily archives to keep. <code>borg.retention.keep_weekly</code> integer <code>4</code> Integer <code>&gt;= 0</code> Number of weekly archives to keep. <code>borg.retention.keep_monthly</code> integer <code>6</code> Integer <code>&gt;= 0</code> Number of monthly archives to keep. <code>borg.retention.keep_yearly</code> integer <code>0</code> Integer <code>&gt;= 0</code> Number of yearly archives to keep. <p>Retention edge case</p> <p>If all retention values are <code>0</code>, BorgBoi warns that archives may accumulate indefinitely.</p>"},{"location":"pages/user-configuration/#ui-section","title":"<code>ui</code> Section","text":"Key Type Default Allowed Values Notes <code>ui.theme</code> string <code>catppuccin</code> Any string Stored in config, but currently not strongly validated at load time. <code>ui.show_progress</code> boolean <code>true</code> <code>true</code> or <code>false</code> Controls whether progress output is shown in relevant operations. <code>ui.color_output</code> boolean <code>true</code> <code>true</code> or <code>false</code> Controls colorized CLI output behavior in supported contexts. <code>ui.table_style</code> string <code>rounded</code> Any string Stored in config; currently not strongly validated at load time."},{"location":"pages/user-configuration/#environment-variables","title":"Environment Variables","text":"<p>Use <code>BORGBOI_</code> variables to override config file values at runtime.</p>"},{"location":"pages/user-configuration/#homeconfig-location","title":"Home/Config Location","text":"Environment Variable Purpose <code>BORGBOI_HOME</code> Overrides the home directory used to resolve <code>.borgboi</code> paths (including <code>config.yaml</code>)."},{"location":"pages/user-configuration/#field-override-variables","title":"Field Override Variables","text":"Environment Variable Config Path <code>BORGBOI_OFFLINE</code> <code>offline</code> <code>BORGBOI_DEBUG</code> <code>debug</code> <code>BORGBOI_AWS__DYNAMODB_REPOS_TABLE</code> <code>aws.dynamodb_repos_table</code> <code>BORGBOI_AWS__DYNAMODB_ARCHIVES_TABLE</code> <code>aws.dynamodb_archives_table</code> <code>BORGBOI_AWS__S3_BUCKET</code> <code>aws.s3_bucket</code> <code>BORGBOI_AWS__REGION</code> <code>aws.region</code> <code>BORGBOI_AWS__PROFILE</code> <code>aws.profile</code> <code>BORGBOI_BORG__EXECUTABLE_PATH</code> <code>borg.executable_path</code> <code>BORGBOI_BORG__DEFAULT_REPO_PATH</code> <code>borg.default_repo_path</code> <code>BORGBOI_BORG__COMPRESSION</code> <code>borg.compression</code> <code>BORGBOI_BORG__CHECKPOINT_INTERVAL</code> <code>borg.checkpoint_interval</code> <code>BORGBOI_BORG__STORAGE_QUOTA</code> <code>borg.storage_quota</code> <code>BORGBOI_BORG__ADDITIONAL_FREE_SPACE</code> <code>borg.additional_free_space</code> <code>BORGBOI_BORG__BORG_PASSPHRASE</code> <code>borg.borg_passphrase</code> <code>BORGBOI_BORG__BORG_NEW_PASSPHRASE</code> <code>borg.borg_new_passphrase</code> <code>BORGBOI_BORG__RETENTION__KEEP_DAILY</code> <code>borg.retention.keep_daily</code> <code>BORGBOI_BORG__RETENTION__KEEP_WEEKLY</code> <code>borg.retention.keep_weekly</code> <code>BORGBOI_BORG__RETENTION__KEEP_MONTHLY</code> <code>borg.retention.keep_monthly</code> <code>BORGBOI_BORG__RETENTION__KEEP_YEARLY</code> <code>borg.retention.keep_yearly</code> <code>BORGBOI_UI__THEME</code> <code>ui.theme</code> <code>BORGBOI_UI__SHOW_PROGRESS</code> <code>ui.show_progress</code> <code>BORGBOI_UI__COLOR_OUTPUT</code> <code>ui.color_output</code> <code>BORGBOI_UI__TABLE_STYLE</code> <code>ui.table_style</code>"},{"location":"pages/user-configuration/#environment-variable-coercion-rules","title":"Environment Variable Coercion Rules","text":"<p>When overrides are read from environment variables:</p> <ul> <li>Boolean values are parsed from: <code>true</code>, <code>1</code>, <code>yes</code>, <code>false</code>, <code>0</code>, <code>no</code> (case-insensitive).</li> <li>Integer parsing is applied to:</li> <li><code>borg.checkpoint_interval</code></li> <li><code>borg.retention.keep_daily</code></li> <li><code>borg.retention.keep_weekly</code></li> <li><code>borg.retention.keep_monthly</code></li> <li><code>borg.retention.keep_yearly</code></li> <li>All other values remain strings.</li> </ul>"},{"location":"pages/user-configuration/#effective-config-examples","title":"Effective-Config Examples","text":"<pre><code># Override only offline mode and bucket for this shell\nexport BORGBOI_OFFLINE=1\nexport BORGBOI_AWS__S3_BUCKET=my-team-bucket\n\nbb config show --format tree\n</code></pre> <pre><code># Use a custom BorgBoi home directory\nexport BORGBOI_HOME=/srv/borgboi-user\nbb config show\n</code></pre> <pre><code># One-off command-level override (without exporting)\nBORGBOI_BORG__COMPRESSION=zstd,9 bb backup daily --name my-docs-backup\n</code></pre>"},{"location":"pages/user-configuration/#validation-and-warnings","title":"Validation and Warnings","text":"<p>BorgBoi validates the final merged config and may warn (without failing) for:</p> <ul> <li>Missing Borg executable in <code>PATH</code></li> <li>Invalid compression algorithm</li> <li>Negative retention values</li> <li>Negative checkpoint interval</li> <li>Missing required AWS fields while not in offline mode</li> </ul> <p>Use this command to inspect the effective final values, including env-var sourced values:</p> <pre><code>bb config show --format tree\n</code></pre>"}]}